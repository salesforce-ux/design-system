// Copyright (c) 2015-present, salesforce.com, inc. All rights reserved
// Licensed under BSD 3-Clause - see LICENSE.txt or git.io/sfdc-license

/**
 * The docked composer relies heavily on utility classes to piece together the layout so please pay close attention to the markup and classes.
 *
 * The overflow menu for docked composer, `.slds-docked-composer--overflow`, displays when the number of docked composers exceeds the width of the viewport. The overflow pill displays with a number indicator for all hidden docked composers. A user can invoke a popover with all available docked composers and replace the furthest left docked composer with the one being selected.
 *
 * When a user clicks on the "pop out" icon in the `.slds-docked-composer__header`, a modal displays and contains the task that was currently in the docked composer.
 *
 * @summary Docked Composer is a persistent utility bar that allows a user to continually use the app to complete tasks or gather information while expanding/collapsing a composer window.
 *
 * @base
 * @name docked-composer
 * @selector .slds-docked-composer
 * @support dev-ready
 */

/**
 * Intializes docked composer containter window
 *
 * @selector .slds-docked_container
 * @restrict div
 */
.slds-docked_container {
  display: flex;
  align-items: flex-end;
  position: fixed;
  bottom: 0;
  right: 0;
  padding: 0 $spacing-large;
  height: $height-docked-bar;
}

/**
 * @variant
 * @name base
 * @selector .slds-docked-composer
 * @restrict section
 * @support dev-ready
 */
.slds-docked-composer {
  position: relative;
  border-radius: $border-radius-medium $border-radius-medium 0 0;
  width: 480px;
  height: $height-docked-bar;
  float: left;
  box-shadow: $elevation-inverse-shadow-2;
  border: $border-width-thin solid $color-border {
    bottom: none;
  }

  /**
   * @selector .slds-is-open
   * @restrict .slds-docked-composer
   * @modifier
   * @group toggle
   */
  &.slds-is-open {
    height: 480px;
  }

  /**
   * @selector .slds-is-closed
   * @restrict .slds-docked-composer
   * @modifier
   * @group toggle
   */
  &.slds-is-closed {

    .slds-docked-composer__body,
    .slds-docked-composer__footer {
      display: none;
    }
  }

  + .slds-docked-composer {
    margin-left: $spacing-large;
  }

  /**
   * Bar at the top of the composer that contains actionable items to invoke,
   * such as minimizing, popping out the composer and removing the composer.
   *
   * @selector .slds-docked-composer__header
   * @restrict .slds-docked-composer header
   */
  &__header {
    background: $color-background-docked-panel-header;
    border-bottom: $border-width-thick solid $color-border-brand;
    border-radius: $border-radius-medium $border-radius-medium 0 0;
    padding: $spacing-x-small $spacing-small;
  }

  &__actions .slds-button {
    margin-left: $spacing-small;
  }

  /**
   * Primary area within docked composer that contains specific task
   *
   * @selector .slds-docked-composer__body
   * @restrict .slds-docked-composer div
   */
  &__body {
    display: flex;
    flex: 1 1 0%;
    flex-direction: column;
    overflow: auto;
  }

  /**
   * @selector .slds-docked-composer__body--form
   * @restrict .slds-docked-composer__body
   * @modifier
   */
  &__body_form,
  &__body--form {
    justify-content: flex-start;
    padding: $spacing-medium;
  }

  /**
   * Within the docked composer body, the lead is the first region
   *
   * @selector .slds-docked-composer__lead
   * @restrict .slds-docked-composer div
   */
  &__lead {
    display: flex;
    background: $color-background-alt;
    padding: $spacing-medium $spacing-x-small;
  }

  /**
   * @selector .slds-docked-composer__toolbar
   * @restrict .slds-docked-composer div
   */
  &__toolbar {
    background: $color-background;
    padding: $spacing-xx-small $spacing-x-small;
    max-height: 60px;
    overflow-y: auto;
    border: {
      top: $border-width-thin solid $color-border;
      bottom: $border-width-thin solid $color-border;
    }
  }

  &__input {
    background: $color-background-alt;
    padding: $spacing-medium;
    min-height: $size-xx-small;
    resize: none;
    line-height: $line-height-text;
    overflow: hidden {
      y: auto;
    }
  }

  /**
   * Bar at the bottom of the composer that contains actionable items to
   * invoke, such as saving, associating relationships and adding content.
   *
   * @selector .slds-docked-composer__footer
   * @restrict .slds-docked-composer footer
   */
  &__footer {
    display: flex;
    background: $color-background;
    padding: $spacing-small $spacing-x-small;
    border-top: $border-width-thin solid $color-border;
  }

  /**
   * When the number of docked composer exceed the width of the viewport, this class modifies the docked composer styles
   *
   * @selector .slds-docked-composer--overflow
   * @restrict .slds-docked-composer
   * @required
   */
  &_overflow,
  &--overflow {
    width: auto;
  }

  &_overflow__button,
  &--overflow__button {
    display: flex;
    background: $color-background-docked-panel-header;
    padding: 0 $spacing-small;
    height: inherit;
    white-space: nowrap;
    border: {
      bottom: {
        left-radius: 0;
        right-radius: 0;
      }
    }
  }

  @include deprecate('4.0.0', 'Use docked-composer--overflow__button instead') {
    &_overflow__pill,
    &--overflow__pill {
      display: flex;
      padding: 0 $spacing-small;
      height: inherit;
      white-space: nowrap;
      border: {
        bottom: {
          left-radius: $border-radius-medium;
          right-radius: $border-radius-medium;
        }
      }

      &:hover,
      &:focus {
        color: $color-text-inverse;
        text-decoration: none;
      }

      .slds-text-body_small,
      .slds-text-body--small {
        color: $color-text-inverse;
        margin-left: $spacing-x-small;
      }
    }
  }
}

// Composer Modal
.slds-docked-composer-modal {

  .slds-modal__content {
    border-radius: $border-radius-medium;
  }

  .slds-docked-composer {
    width: 100%;
    height: 100%;
    border: 0;
  }
}
