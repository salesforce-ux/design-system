// Copyright (c) 2015-present, salesforce.com, inc. All rights reserved
// Licensed under BSD 3-Clause - see LICENSE.txt or git.io/sfdc-license

/**
 * A picklist is a list of actionable items that is invoked by selection of a
 * particular item. That value is then shown as selected and its value is updated
 * within the `.slds-picklist__label`.
 *
 * A multi-select picklist is a list of actionable items that is invoked by
 * selection of a particular item(s). The multi-select picklist can have more
 * than one selected option. When more than one option has been selected, the
 * `.slds-picklist__label` test should update with the total number of selected
 * items, such as "3 options selected". When the picklist loses focus but has
 * items selected, a `.slds-pill_container--bare` should be display below the
 * `.slds-picklist__label` with the selected items in pills, allowing a user to
 * easily remove selected items.
 *
 * The target HTML element and dropdown need to be wrapped in the class
 * `.slds-dropdown-trigger dropdown-trigger--click`.
 *
 * #### Accessibility
 *
 * The main thing that distinguishes menus from other popover blocks is keyboard
 * navigation: elsewhere, users press the Tab key to navigate through actionable
 * items, but in a menu, users press the arrow keys to navigate.
 *
 * **Expected markup:**
 *
 * - Menu trigger is a focusable element (`<a>` or `<button>`) with `aria-haspopup="true"`
 * - Menu has `role="menu"` and an `aria-labelledby` attribute whose value is the id of the menu trigger
 * - Menu items have `role="menuitem"`, `role="menuitemcheckbox"`, or `role="menuitemradio"`
 *
 * **Expected keyboard interactions:**
 *
 * - Arrow keys cycle focus through menu items (you should use JS to disable focus for any disabled items)
 * - Tab key closes menu and moves focus to the next focusable element on the page
 * - Esc key closes menu and moves focus back to the menu trigger
 * - Any character key moves focus to the next menu item that starts with that character, if applicable
 *
 * @summary Picklists, commonly known as dropdown menus, allow the user to select one option or multiple options from a list. Picklists are used instead of radio lists and checkbox lists inside of a larger form. They provide more flexibility in the number of options the user can choose from.
 *
 * @base
 * @name picklist
 * @selector .slds-picklist
 * @support dev-ready
 * @category complex
 * @type user-input
 * @role combobox, listbox
 */

/**
 * @name base
 * @selector .slds-picklist
 * @restrict div
 * @required
 * @variant
 */
.slds-picklist {
  position: relative;

  // Force width on picklist
  .slds-dropdown {
    width: $size-small;
  }

  li {
    /**
     * Set default state of icon for when a listbox option is selected
     *
     * @selector .slds-icon--selected
     * @restrict .slds-picklist li svg
     * @required
     */
    .slds-icon_selected,
    .slds-icon--selected {
      opacity: 0;
      transition: opacity $duration-immediately ease;
    }

    /**
     * Toggles state of icon for when a listbox option is selected
     *
     * @selector .slds-is-selected
     * @restrict .slds-picklist li
     * @modifier
     * @required
     */
    &.slds-is-selected .slds-icon_selected,
    &.slds-is-selected .slds-icon--selected {
      fill: $color-text-icon-default-hover;
      opacity: 1;
    }
  }

  /**
   * Resets explicit width on picklist to be fluid to its parent element
   *
   * @selector .slds-picklist--fluid
   * @restrict .slds-picklist
   * @modifier
   */
  &_fluid,
  &--fluid {

    .slds-picklist__input,
    .slds-picklist__label,
    .slds-dropdown,
    .slds-lookup {
      width: auto;
      min-width: 0;
      max-width: $size-small;
    }
  }
}

/**
 * Read-only input element for picklist
 *
 * @selector .slds-picklist__input
 * @restrict .slds-picklist .slds-form-element__control
 * @required
 */
.slds-picklist__input {
  width: $size-small;

  .slds-button {
    line-height: 0;
  }
}

@include deprecate('4.0.0', 'Use lookup classes instead') {

  .slds-picklist__label {
    padding-right: $spacing-x-large;
    width: $size-small;
    color: $color-text-default;
    text-align: left;

    .slds-icon {
      @include square($square-icon-small-content);
      position: absolute;
      right: $spacing-medium;
      top: 50%;
      margin-top: (($square-icon-small-content / 2) * -1);
      fill: $color-text-icon-default;
    }

    .slds-truncate {
      display: block;
    }
  }
}
